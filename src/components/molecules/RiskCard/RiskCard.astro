---
/**
 * RiskCard Component
 * Hunter Galloway Design System - Molecular Component
 * 
 * Individual risk item card displaying icon, title, and content blocks.
 * Used within RiskWidget sections for WordPress-exact risk mitigation content.
 * Follows atomic design principles with icon atoms and typography.
 */

import type { RiskCardProps } from './RiskCard.types';
import { semantic } from '../../../tokens/semantic';

interface Props extends RiskCardProps {}

const {
  id,
  title,
  content,
  icon,
  customIcon,
  variant = 'default',
  class: additionalClasses = '',
} = Astro.props;

// Icon mapping to WordPress exact data URIs and SVGs
const iconMap = {
  scheme: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAPDSURBVHgBvVj/VeMwDP7g8T+MYDYIE5xvguMmaDYoGzRMADdBywQtEzQblA3ITdBu0IuuElYcOb8KfO/pxYll+7Mky3aAr8OyliPLAt8AX8t9LW6Abo4TsV0t71z2+EI8IViDBnQ9+gXr/sLJelL+EmSK2LMqb2tZJ9p4hAmR7GFP6qaWeS0zLp9FkMgsooGPHe1yhMlkRr1DcL/oTSa5Rdsa8k2DBvBKjqxnIef6ZwTP5LHSFYbhJzd2tWxqqRJ6RCbDMIi1rmu54PJ+aMMhprYs+M6DLJXcd4wTu7gXOsaeMI3goIEYDmFSvUbxCDORmenUMOeOjmcK9b3AwEldRbMhvNRS4mShu1peucOilgPXnQPHfclYnbhQZYkJbWoi+IYwQ1osldEPtdG7DFn6NaFLOrtoHNK75XJeyw+cDPFqNRY36uDuShdAM9i1EBFv6Ev8LlkeFDnd3hzTCn5LOUewGJXnCPmP3tdIHxasMfT3rENnEMEbhCQbk9aWdwjWXfSMQZBJLRFW92iCGXfk0U4N1op0aJ9oUgS1LskDJhDc8buLdOYIW2HsUh/1kXSf0i3o5RLj4HCyYLxCya3k7gNLHrUrWTyGnSc/cNlDRkQTIawNXTAxShd3Rn+S8zxGoOuw8G58k5j7G30v+bnh8iPaCb3ip+sZowGL4AvaCTZHNyiZUxKn2PMskuSnoBrbVgI8R+LchmDde9grMFffuxZJA1eq0/kA/ZKfs1pWUd0uIhq7Tw4eG0y4nxToP4XEKcIbfcg2GVvPIWx9ug8NuZ8UMFZ6kRhUoAl6pG935yRqnaBbl6wCwwlq/ZgkhcpMvXs1cKG+b2F7aa36/q/fdyfZwk6sBT8XTGDDQulHEvUMYcKPaBIUlGhOhtx8ze8HqaBZS+xoizgEc8cW1J3K1peKW2+0s1ysTz8Nz8ipQZ8kNMEt16cu36IrAU6S9+hasUrw3PbjEHLBJCgp/uZGJU5J16l32nvpElUhfeUciowJpNzeQhywkiIcmq4tkD45j5E9EseoFBxOSXcbNYwJDoHlOo/2Kh4MWsUV7K1L/hA4lsrQoQWmdwVy3QFpUD0tqj/c/0zVUViVMAgiQW6tCJIVbw09uYdoVNH7Gw/8pur3/CyZdIaR50Q6fJJbyEIrhItMDIlfr2TIbxONFffR9yejgQLNywuVXaSTqboZpkH/GB0Vp/GPnbihQ/s3iMd47BH+H0p5FDzs2JAzXxGVx0I2CQmpHT4JHmFLkq1uipv1NkvPDJ+IAsG9K0yHrGJzcf0DmGawuv4vemgAAAAASUVORK5CYII=',
  umbrella: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAIOSURBVHgB7VntUcMwDH3HMUBGMBNQJsAbwAaUCegG9Qhs0DBBYYKwQdmgbFA2gOgq1apbKcm1pX/67nQG61l+kT9kAA7HuLXf1p4czmMPDq5wOAK3Nw5nxO2dw8E1/gd10fYCpbNprXI4obWX1matLVtbYb0E1C5am7M/wEfVxWk4cNzji8rf14hv7RP5EBMTrL8sqL5RIWJV/D5nzrzo06KW2M3CCh1iSrwUIhLW6R3vmaRCXrIH7k/MkRhTFZv8ET0xxfaX6n0kmSmXICEvj560NgQNFpIKX1C+UPgq5asMoYMEjdWgieNvjPGNM3aiYj+iAwF5jZPBqZ3J9IQzw/+KvAe9K2Qz0dLhLGAff3B/VwzJXrIIATmFETasPSHQ+8ZCREd2JL2NE2SkgniQIx4czk52dKF84rZ2AshXfMHHN7fB4bxxey8d12oSqaxUfeVWpf4fDl5j+4KjCzGqcVA8AflusT45oeC9889RzbPp+D2j0fybZQqFato/d5wlap+RUy/4Yp6k+83gfTLvxokX9ICEfBy9sy8FcLFnbFJ9sjnn8LF1QV4p9RL4xxn8we0rfEi23jt4Em9Q9faQ0HGB9cUx3sBHw0WMhYsYCxcxFi5iLJxKDNU3qjvTIYOOKUYXWHrHRPT4C+DYiMhPURIRkKv7DGeAPAW0rdD9n4iTgJaoRn6Ik7jRwBj4A/+t2wsaJVKWAAAAAElFTkSuQmCC',
  'video-conference': '/images/video-conference.svg',
  arrow: '/images/risk_arrow.svg',
  puzzle: '/images/risk_puzzle.svg',
  dollar: '/images/nurse_risk2.svg',
};

// Get icon source
const iconSrc = icon === 'custom' && customIcon ? customIcon : iconMap[icon];

// Icon size mapping
const iconSizes = {
  scheme: { width: '40px', height: '40px' },
  umbrella: { width: '35px', height: '35px' },
  'video-conference': { width: '43px', height: '43px' },
  arrow: { width: '44px', height: '44px' },
  puzzle: { width: '40px', height: '40px' },
  dollar: { width: '50px', height: '50px' },
};

const iconSize = iconSizes[icon] || { width: '40px', height: '40px' };

// Build CSS classes
const cardClasses = [
  'hg-risk-card',
  `hg-risk-card--${variant}`,
  `${icon}_ico`,
  additionalClasses,
].filter(Boolean).join(' ');
---

<li class={cardClasses} id={id}>
  <p class="list_title">{title}</p>
  {content.map((textBlock) => (
    <p class="list_text" set:html={textBlock} />
  ))}
</li>

<style define:vars={{
  listTitleFontWeight: '900',
  listTitleFontSize: '20px',
  listTitlePaddingBottom: '8px',
  listTextFontSize: '17px',
  listTextLineHeight: '1.2',
  iconWidth: iconSize.width,
  iconHeight: iconSize.height,
  iconSrc: iconSrc.startsWith('data:') ? `url("${iconSrc}")` : `url("${iconSrc}")`,
}}>
/* RiskCard - WordPress Exact Implementation */
.hg-risk-card {
  position: relative;
  padding: 0 0 34px 54px;
  list-style: none;
}

/* Icon styling */
.hg-risk-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  display: block;
  background-image: var(--iconSrc);
  background-repeat: no-repeat;
  background-position: center;
  background-size: contain;
  width: var(--iconWidth);
  height: var(--iconHeight);
}

.hg-risk-card .list_title {
  font-weight: var(--listTitleFontWeight);
  font-size: var(--listTitleFontSize);
  padding-bottom: var(--listTitlePaddingBottom);
  margin: 0;
}

.hg-risk-card .list_text {
  font-size: var(--listTextFontSize);
  line-height: var(--listTextLineHeight);
  margin: 0 0 16px 0;
}

.hg-risk-card .list_text:last-child {
  margin-bottom: 0;
}

/* Variant styles */
.hg-risk-card--compact {
  padding-bottom: 24px;
}

.hg-risk-card--highlighted .list_title {
  color: var(--brand-primary);
}

/* Mobile responsive */
@media screen and (max-width: 767px) {
  .hg-risk-card {
    font-size: 13px;
  }
  
  .hg-risk-card .list_title {
    font-size: 17px;
    padding-bottom: 25px;
  }
  
  .hg-risk-card .list_text {
    font-size: 13px;
    line-height: 1.4;
    margin-left: -54px;
  }
}
</style>
