---
/**
 * RiskWidget Component
 * Hunter Galloway Design System - Section Component
 * 
 * A section component for displaying risk mitigation and trust-building content.
 * Used across multiple pages to address customer concerns about loan rejection.
 * Built to match the WordPress risk_widget pattern exactly.
 */

import type { RiskWidgetProps } from './RiskWidget.types';
import RiskCard from '../../molecules/RiskCard/RiskCard.astro';
import Image from '../../atoms/Image/Image.astro';
import { semantic } from '../../../tokens/semantic';

interface Props extends RiskWidgetProps {}

const {
  title,
  introText,
  items,
  image,
  marketStat,
  variant = 'default',
  class: additionalClasses = '',
} = Astro.props;

// Build CSS classes based on variant
const widgetClasses = [
  'risk_widget',
  'widget',
  `risk-widget--${variant}`,
  additionalClasses,
].filter(Boolean).join(' ');
---

<section class={widgetClasses}>
  <div class="container">
    <div class="inner_widget">
      <h2 class="inner_title">{title}</h2>
      <div class="risk_holder">
        <div class="risk_inner-left">
          {introText && (
            <div class="intro_text">
              {introText}
              {marketStat && (
                <span class="market_text">
                  {marketStat.text} <strong class="market_percentage">{marketStat.percentage}</strong>
                  <span class="tooltip-trigger" title={marketStat.tooltipText}>â“˜</span>
                </span>
              )}
            </div>
          )}
          <ul class="risk_list">
            {items.map((item) => (
              <RiskCard 
                icon={item.icon}
                title={item.title}
                description={item.description}
                variant={item.variant || 'default'}
              />
            ))}
          </ul>
        </div>
        {image && (
          <div class="risk_imgwrap">
            <Image 
              src={image.src}
              alt={image.alt}
              loading="lazy"
              fit="cover"
              radius="md"
            />
          </div>
        )}
      </div>
    </div>
  </div>
</section>

<style define:vars={{
  surfacePrimary: semantic.color.surface.primary,
  surfaceSecondary: semantic.color.surface.secondary,
  surfaceTertiary: semantic.color.surface.tertiary,
  textPrimary: semantic.color.text.primary,
  textSecondary: semantic.color.text.secondary,
  brandPrimary: semantic.color.brand.primary,
  fontSize4xl: semantic.typography.size['4xl'], // 40px - WordPress exact
  fontSizeLg: semantic.typography.size.lg,
  fontSizeMd: semantic.typography.size.md,
  fontWeightDisplay: semantic.typography.weight.display,
  fontWeightHeading: semantic.typography.weight.heading,
  lineHeightTight: semantic.typography.lineHeight.tight,
  lineHeightBody: semantic.typography.lineHeight.body,
  radiusLg: semantic.radius.lg,
  radiusMd: semantic.radius.md,
  spaceLg: semantic.space.lg,
  spaceMd: semantic.space.md,
  spaceXl: semantic.space.xl,
  space2xl: semantic.space['2xl'],
  space3xl: semantic.space['3xl'],
}}>
/* RiskWidget component styles - WordPress exact implementation */
.risk_widget {
  margin-bottom: var(--space2xl);
}

.risk_widget .inner_widget {
  background: #eeeeee; /* WordPress exact gray */
  border-radius: 10px; /* WordPress exact */
  padding: 60px 70px; /* WordPress exact */
  position: relative;
}

.risk_widget .inner_title {
  font-size: var(--fontSize4xl); /* 40px - WordPress exact */
  font-weight: var(--fontWeightDisplay);
  color: var(--textPrimary);
  line-height: var(--lineHeightTight);
  margin-bottom: var(--space3xl);
  text-align: center;
  max-width: 800px;
  margin-left: auto;
  margin-right: auto;
  margin-bottom: 45px; /* WordPress exact */
}

.risk_holder {
  display: flex;
  flex-wrap: wrap;
  align-items: flex-start;
  gap: var(--spaceLg);
}

.risk_inner-left {
  flex: 0 0 45%; /* WordPress exact */
  font-size: var(--fontSizeMd); /* 17px - WordPress exact */
  line-height: var(--lineHeightBody);
  color: var(--textPrimary);
}

.intro_text {
  margin-bottom: var(--spaceLg);
  font-size: var(--fontSizeMd);
  line-height: var(--lineHeightBody);
}

.market_text {
  display: inline-block;
  margin-top: var(--spaceSm);
}

.market_percentage {
  color: var(--brandPrimary);
  font-weight: var(--fontWeightHeading);
}

.tooltip-trigger {
  display: inline-block;
  margin-left: 4px;
  color: var(--brandPrimary);
  cursor: help;
  font-size: 0.9em;
}

.risk_list {
  list-style: none;
  padding: 0;
  margin: 0;
  padding-top: 45px; /* WordPress exact */
}

.risk_imgwrap {
  flex: 0 0 55%; /* WordPress exact */
  position: relative;
  min-height: 300px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.risk_imgwrap img {
  width: 100%;
  height: auto;
  max-width: 100%;
  border-radius: var(--radiusMd);
}

/* Style variant: default - standard WordPress styling */
.risk-widget--default .inner_widget {
  background: #eeeeee;
}

/* Style variant: light - lighter background */
.risk-widget--light .inner_widget {
  background: #F2F2F2; /* Post/suburb template variation */
}

.risk-widget--light .risk_list li {
  background: var(--surfacePrimary);
  border-radius: var(--radiusMd);
  padding: var(--spaceMd);
  margin-bottom: var(--spaceSm);
}

/* Style variant: reversed - image on left, content on right */
.risk-widget--reversed .risk_holder {
  flex-direction: row-reverse;
}

.risk-widget--reversed .risk_inner-left {
  flex: 0 0 58%; /* Doctor variant - wider content area */
}

.risk-widget--reversed .risk_imgwrap {
  flex: 0 0 42%;
}

/* Responsive design matching WordPress patterns */
@media (max-width: 991px) {
  .risk_widget .inner_widget {
    padding: 40px 20px; /* WordPress tablet */
  }
  
  .risk_holder {
    flex-direction: column;
    gap: var(--spaceMd);
  }
  
  .risk_inner-left,
  .risk_imgwrap {
    flex: 1 1 100%;
  }
  
  .risk-widget--reversed .risk_inner-left,
  .risk-widget--reversed .risk_imgwrap {
    flex: 1 1 100%;
  }
}

@media (max-width: 767px) {
  .risk_widget .inner_widget {
    padding: 40px 20px; /* WordPress mobile */
  }
  
  .risk_widget .inner_title {
    font-size: 28px; /* WordPress mobile title size */
    margin-bottom: 30px;
  }
  
  .risk_inner-left {
    font-size: var(--fontSizeSm); /* 13px - WordPress mobile */
  }
  
  .risk_list {
    padding-top: 30px; /* Reduced spacing for mobile */
  }
  
  .risk_imgwrap {
    min-height: 200px;
  }
}

/* Container */
.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 var(--spaceLg);
}

@media (max-width: 768px) {
  .container {
    padding: 0 1rem;
  }
}
</style>